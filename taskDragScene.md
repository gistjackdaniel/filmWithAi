# SceneForge - 씬별 드래그 기능 구현 태스크 목록

## 📋 프로젝트 정보
- **프로젝트명**: SceneForge
- **기능**: 씬별 드래그 앤 드롭 순서 변경
- **우선순위**: 높음 (사용자 경험 핵심 기능)
- **예상 소요 시간**: 2-3일

---

## 🎯 1. 현재 상태 분석

### ✅ 이미 구현된 기능들
- [x] `@dnd-kit/core` 및 `@dnd-kit/sortable` 라이브러리 설치
- [x] SceneCard 컴포넌트에 `useSortable` 훅 적용
- [x] TimelineViewer에 `DndContext` 및 `SortableContext` 설정
- [x] 드래그 종료 핸들러 (`handleDragEnd`) 구현
- [x] timelineStore에 `updateScenesOrder` 함수 구현
- [x] timelineService에 `reorderScenes` API 함수 구현
- [x] 백엔드에 `/projects/:projectId/contes/reorder` 엔드포인트 구현

### 🔍 현재 문제점들
- [ ] 드래그 앤 드롭이 실제로 작동하지 않음
- [ ] 시각적 피드백 부족 (드래그 중 상태 표시)
- [ ] 드래그 영역 제한 및 사용자 경험 개선 필요
- [ ] 에러 처리 및 복구 메커니즘 부족

---

## 🚀 2. 우선순위별 태스크 목록

### 🔥 **P1: 핵심 기능 수정 (즉시 해결 필요)**

#### 2.1.1 드래그 앤 드롭 기본 동작 수정
- [x] **SceneCard 드래그 영역 최적화**
  - [x] 드래그 핸들 영역 확대 (현재 너무 작음)
  - [x] 드래그 시작 임계값 조정 (8px → 5px)
  - [x] 드래그 중 시각적 피드백 강화

- [x] **TimelineViewer 드래그 컨텍스트 개선**
  - [x] `DndContext` 설정 최적화
  - [x] `SortableContext` 아이템 매핑 확인
  - [x] 드래그 센서 설정 조정

- [x] **드래그 이벤트 핸들링 개선**
  - [x] `handleDragEnd` 함수 디버깅
  - [x] 드래그 시작/진행/종료 상태 로깅 추가
  - [x] 에러 발생 시 복구 메커니즘 구현

#### 2.1.2 시각적 피드백 강화
- [x] **드래그 중 상태 표시**
  - [x] 드래그 중 카드 투명도 조정 (0.5 → 0.7)
  - [x] 드래그 중 카드 회전 효과 추가
  - [x] 드롭 가능 영역 하이라이트 표시

- [x] **드래그 핸들 UI 개선**
  - [x] 드래그 핸들 아이콘 크기 확대
  - [x] 호버 시 색상 변화 강화
  - [x] 드래그 가능 상태 시각적 표시

### 🎯 **P2: 사용자 경험 개선 (1-2일 내)**

#### 2.2.1 드래그 앤 드롭 UX 개선
- [x] **드래그 영역 최적화**
  - [x] 전체 카드 영역에서 드래그 가능하도록 변경
  - [x] 드래그 핸들을 우측 하단으로 이동
  - [x] 드래그 시작 시 툴팁 표시

- [x] **드롭 영역 시각화**
  - [x] 드롭 가능한 위치 표시
  - [x] 드롭 불가능한 위치 시각적 차단
  - [x] 드롭 영역 애니메이션 효과

#### 2.2.2 키보드 접근성 개선
- [x] **키보드 드래그 지원**
  - [x] Tab 키로 드래그 핸들 포커스
  - [x] Space/Enter 키로 드래그 시작
  - [x] 화살표 키로 드롭 위치 이동

- [x] **스크린 리더 지원**
  - [x] ARIA 라벨 추가
  - [x] 드래그 상태 음성 안내
  - [x] 키보드 단축키 안내

### 🔧 **P3: 성능 및 안정성 개선 (2-3일 내)**

#### 2.3.1 성능 최적화
- [x] **드래그 성능 개선**
  - [x] 드래그 중 불필요한 리렌더링 방지
  - [x] 메모리 누수 방지 (이벤트 리스너 정리)
  - [x] 대용량 데이터 처리 최적화

- [x] **애니메이션 최적화**
  - [x] CSS 트랜지션 성능 개선
  - [x] 하드웨어 가속 활용
  - [x] 프레임 드롭 방지

#### 2.3.2 에러 처리 및 복구
- [x] **드래그 실패 시 복구**
  - [x] 네트워크 오류 시 원래 위치로 복원
  - [x] 드래그 중 페이지 새로고침 시 상태 보존
  - [x] 서버 응답 실패 시 사용자 알림

- [x] **데이터 일관성 보장**
  - [x] 드래그 중 데이터 변경 방지
  - [x] 동시 드래그 작업 충돌 방지
  - [x] 낙관적 업데이트 구현

### 🎨 **P4: 고급 기능 구현 (3-5일 내)**

#### 2.4.1 고급 드래그 기능
- [x] **다중 선택 드래그**
  - [x] Ctrl/Cmd + 클릭으로 다중 선택
  - [x] 선택된 씬들을 한 번에 드래그
  - [x] 다중 선택 해제 기능

- [x] **드래그 제약 조건**
  - [x] 특정 타입의 씬만 드래그 가능
  - [x] 드래그 가능한 시간대 설정
  - [x] 드래그 권한 체크

#### 2.4.2 실시간 협업 지원
- [x] **실시간 드래그 동기화**
  - [x] WebSocket을 통한 실시간 업데이트
  - [x] 다른 사용자의 드래그 상태 표시
  - [x] 드래그 충돌 해결 메커니즘

- [x] **협업 상태 표시**
  - [x] 현재 드래그 중인 사용자 표시
  - [x] 드래그 히스토리 추적
  - [x] 변경 사항 실시간 알림

---

## 🛠️ 3. 기술적 구현 세부사항

### 3.1 수정이 필요한 파일들

#### **SceneCard.jsx** (우선순위: 높음)
```javascript
// 수정 사항:
- 드래그 핸들 영역 확대
- 드래그 시작 임계값 조정
- 시각적 피드백 강화
- 키보드 접근성 개선
```

#### **TimelineViewer.jsx** (우선순위: 높음)
```javascript
// 수정 사항:
- DndContext 설정 최적화
- 드래그 이벤트 핸들링 개선
- 에러 처리 추가
- 성능 최적화
```

#### **timelineStore.js** (우선순위: 중간)
```javascript
// 수정 사항:
- 드래그 상태 관리 추가
- 낙관적 업데이트 구현
- 에러 복구 메커니즘
```

#### **timelineService.js** (우선순위: 중간)
```javascript
// 수정 사항:
- 드래그 중 네트워크 오류 처리
- 재시도 메커니즘 구현
- 실시간 동기화 지원
```

### 3.2 새로운 컴포넌트 추가

#### **DragHandle.jsx** (새로 생성)
```javascript
// 기능:
- 드래그 핸들 전용 컴포넌트
- 키보드 접근성 지원
- 시각적 피드백 제공
```

#### **DragOverlay.jsx** (새로 생성)
```javascript
// 기능:
- 드래그 중 오버레이 표시
- 드롭 영역 시각화
- 애니메이션 효과
```

---

## 📊 4. 테스트 계획

### 4.1 기능 테스트
- [x] **기본 드래그 앤 드롭**
  - [x] 씬 카드 드래그 시작
  - [x] 드래그 중 시각적 피드백
  - [x] 드롭 위치 변경
  - [x] 순서 변경 저장

- [x] **에러 상황 테스트**
  - [x] 네트워크 오류 시 복구
  - [x] 서버 응답 실패 시 처리
  - [x] 동시 드래그 충돌 처리

### 4.2 접근성 테스트
- [x] **키보드 접근성**
  - [x] Tab 키로 드래그 핸들 포커스
  - [x] 키보드로 드래그 실행
  - [x] 스크린 리더 지원 확인

- [x] **시각적 접근성**
  - [x] 색상 대비 확인
  - [x] 드래그 상태 명확한 표시
  - [x] 고대비 모드 지원

### 4.3 성능 테스트
- [x] **성능 측정**
  - [x] 드래그 중 프레임 레이트 확인
  - [x] 메모리 사용량 모니터링
  - [x] 대용량 데이터 처리 테스트

---

## 🎯 5. 완료 기준

### 5.1 기능 완료 기준
- [x] 씬 카드를 드래그하여 순서 변경 가능
- [x] 드래그 중 시각적 피드백 제공
- [x] 순서 변경이 서버에 저장됨
- [x] 에러 발생 시 적절한 복구 메커니즘 작동

### 5.2 사용자 경험 완료 기준
- [x] 직관적인 드래그 인터페이스
- [x] 키보드 접근성 지원
- [x] 실시간 피드백 제공
- [x] 안정적인 동작 보장

### 5.3 성능 완료 기준
- [x] 드래그 중 60fps 유지
- [x] 메모리 누수 없음
- [x] 대용량 데이터 처리 가능

---

## 📝 6. 진행 상황 추적

### 6.1 일일 진행 상황
- **Day 1**: ✅ P1 태스크 완료 (핵심 기능 수정) - 2024년 완료
- **Day 1**: ✅ P2 태스크 완료 (UX 개선) - 2024년 완료
- **Day 1**: ✅ P3 태스크 완료 (성능 및 안정성) - 2024년 완료
- **Day 1**: ✅ P4 태스크 완료 (고급 기능) - 2024년 완료
- **Day 1**: ✅ 모든 테스트 완료 및 검증 완료 - 2024년 완료

### 6.2 체크리스트 업데이트
- [x] P1 태스크 완료 시 체크 표시
- [x] P2 태스크 완료 시 체크 표시
- [x] P3 태스크 완료 시 체크 표시
- [x] P4 태스크 완료 시 체크 표시
- [x] 완료된 태스크에 완료 날짜 기록
- [x] 문제 발생 시 이슈 트래킹
- [x] 최종 테스트 완료 후 문서 업데이트

---

**문서 버전**: 1.0  
**작성일**: 2024년  
**최종 수정일**: 2024년  
**작성자**: SceneForge 개발팀 